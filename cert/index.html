<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Key Certificates Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 50px;
        }

        .section h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .section h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin: 30px 0 15px 0;
        }

        /* Comparison Table Styles */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            border-radius: 10px;
        }

        .comparison-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .comparison-table th {
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1.1em;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table tbody tr:hover {
            background-color: #f5f5f5;
            transition: background-color 0.3s ease;
        }

        .comparison-table tbody tr:last-child td {
            border-bottom: none;
        }

        .cert-type {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }

        /* Certificate Chain Diagrams */
        .diagram-container {
            display: flex;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .chain {
            flex: 1;
            min-width: 400px;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chain h4 {
            color: #667eea;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.3em;
        }

        .cert-box {
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .cert-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .cert-box.root {
            border-color: #e74c3c;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%);
        }

        .cert-box.intermediate {
            border-color: #f39c12;
            background: linear-gradient(135deg, #fffbf0 0%, #fff3d4 100%);
        }

        .cert-box.leaf {
            border-color: #27ae60;
            background: linear-gradient(135deg, #f0fff4 0%, #d4f4dd 100%);
        }

        .cert-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .cert-details {
            font-size: 0.9em;
            color: #555;
            line-height: 1.8;
        }

        .cert-oid {
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            margin-top: 10px;
        }

        .arrow {
            text-align: center;
            font-size: 2em;
            color: #667eea;
            margin: 10px 0;
        }

        /* Key Differences Section */
        .key-diff {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .diff-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .diff-card h4 {
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .diff-card ul {
            list-style: none;
            padding-left: 0;
        }

        .diff-card li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .diff-card li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        /* Analogy Box */
        .analogy {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #f39c12;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .analogy h4 {
            color: #d35400;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .analogy p {
            color: #555;
            font-size: 1.05em;
            line-height: 1.8;
        }

        /* Tag Information */
        .tag-info {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #27ae60;
        }

        .tag-info strong {
            color: #27ae60;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            header h1 {
                font-size: 1.8em;
            }

            .comparison-table {
                font-size: 0.9em;
            }

            .diagram-container {
                flex-direction: column;
            }

            .chain {
                min-width: 100%;
            }
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-box {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 3px solid;
        }

        .legend-box.root { border-color: #e74c3c; background: #ffe5e5; }
        .legend-box.intermediate { border-color: #f39c12; background: #fff3d4; }
        .legend-box.leaf { border-color: #27ae60; background: #d4f4dd; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Digital Key Certificates Guide</h1>
            <p>Understanding [E], [H], [S], and [T] Certificates in CCC Digital Key Infrastructure</p>
        </header>

        <div class="content">
            <!-- Quick Comparison Table -->
            <div class="section">
                <h2>üìä Quick Comparison Table</h2>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>[E] Instance CA</th>
                            <th>[H] Digital Key</th>
                            <th>[S] SBxD/KIS Intermediate CA</th>
                            <th>[T] SBxD/KIS Endpoint</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="cert-type">Certificate Type</td>
                            <td>Intermediate CA</td>
                            <td>Leaf (Endpoint)</td>
                            <td>Intermediate CA (Optional)</td>
                            <td>Leaf (Endpoint)</td>
                        </tr>
                        <tr>
                            <td class="cert-type">OID</td>
                            <td>1.3.6.1.4.1.41577.5.3</td>
                            <td>1.3.6.1.4.1.41577.5.4</td>
                            <td>1.3.6.1.4.1.41577.5.15</td>
                            <td>1.3.6.1.4.1.41577.5.16</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Signed By</td>
                            <td>Device OEM CA (via [F])</td>
                            <td>Instance CA</td>
                            <td>SBxD/KIS Root [U]</td>
                            <td>SBxD/KIS Intermediate CA [S]</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Used For</td>
                            <td>Device-based key creation</td>
                            <td>Device-based key attestation</td>
                            <td>Server-based key sharing</td>
                            <td>Server-based key attestation</td>
                        </tr>
                        <tr>
                            <td class="cert-type">CA Flag</td>
                            <td>CA=TRUE, pathLen=0</td>
                            <td>CA=FALSE</td>
                            <td>CA=TRUE, pathLen=0</td>
                            <td>CA=TRUE, pathLen=0</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Key Usage</td>
                            <td>Certificate Sign only</td>
                            <td>Digital Signature</td>
                            <td>Certificate Sign only</td>
                            <td>Digital Signature</td>
                        </tr>
                        <tr>
                            <td class="cert-type">GET DATA Tag</td>
                            <td>7F22h</td>
                            <td>7F24h</td>
                            <td>7F42h</td>
                            <td>7F44h</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Max Size</td>
                            <td>650 bytes</td>
                            <td>650-970 bytes</td>
                            <td>Standard X.509</td>
                            <td>Standard X.509</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Use Case</td>
                            <td>Owner Pairing (Phone)</td>
                            <td>Owner Pairing (Phone)</td>
                            <td>Server-based Sharing (SiaC)</td>
                            <td>Server-based Sharing (SiaC)</td>
                        </tr>
                        <tr>
                            <td class="cert-type">Special Features</td>
                            <td>Contains applet_version, platform_information</td>
                            <td>Contains vehicle_PK, authorized_PK_list, endpoint config</td>
                            <td>Similar to [E], server context</td>
                            <td>Must have revocation check (CRL/OCSP)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Certificate Chain Diagrams -->
            <div class="section">
                <h2>üîó Certificate Chain Diagrams</h2>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box root"></div>
                        <span>Root CA</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box intermediate"></div>
                        <span>Intermediate CA</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box leaf"></div>
                        <span>Leaf Certificate</span>
                    </div>
                </div>

                <div class="diagram-container">
                    <!-- Device-Based Chain -->
                    <div class="chain">
                        <h4>üì± Device-Based Key Chain (Owner Pairing)</h4>
                        
                        <div class="cert-box root">
                            <div class="cert-title">Vehicle OEM CA [J]</div>
                            <div class="cert-details">
                                ‚Ä¢ Root of trust<br>
                                ‚Ä¢ Signs Device OEM CA
                            </div>
                        </div>

                        <div class="arrow">‚Üì signs</div>

                        <div class="cert-box intermediate">
                            <div class="cert-title">[F] Device OEM CA Certificate</div>
                            <div class="cert-details">
                                ‚Ä¢ Signed by Vehicle OEM CA<br>
                                ‚Ä¢ Stored in device OS<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F20h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.2</div>
                        </div>

                        <div class="arrow">‚Üì signs</div>

                        <div class="cert-box intermediate">
                            <div class="cert-title">[E] Instance CA Certificate</div>
                            <div class="cert-details">
                                ‚Ä¢ Signed by Device OEM CA<br>
                                ‚Ä¢ Per Vehicle OEM<br>
                                ‚Ä¢ Contains applet_version<br>
                                ‚Ä¢ CA=TRUE, pathLen=0<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F22h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.3</div>
                        </div>

                        <div class="arrow">‚Üì signs</div>

                        <div class="cert-box leaf">
                            <div class="cert-title">[H] Digital Key Certificate</div>
                            <div class="cert-details">
                                ‚Ä¢ Leaf certificate<br>
                                ‚Ä¢ Attests device's public key<br>
                                ‚Ä¢ Contains vehicle_PK, authorized_PK<br>
                                ‚Ä¢ CA=FALSE<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F24h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.4</div>
                        </div>
                    </div>

                    <!-- Server-Based Chain -->
                    <div class="chain">
                        <h4>‚òÅÔ∏è Server-Based Key Chain (SiaC)</h4>
                        
                        <div class="cert-box root">
                            <div class="cert-title">Vehicle OEM CA [J]</div>
                            <div class="cert-details">
                                ‚Ä¢ Root of trust<br>
                                ‚Ä¢ Validates server certificates
                            </div>
                        </div>

                        <div class="arrow">‚Üì validates</div>

                        <div class="cert-box intermediate">
                            <div class="cert-title">[F] External CA Certificate</div>
                            <div class="cert-details">
                                ‚Ä¢ Bridge to server infrastructure<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F20h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.2</div>
                        </div>

                        <div class="arrow">‚Üì signs</div>

                        <div class="cert-box intermediate">
                            <div class="cert-title">[S] SBxD/KIS Intermediate CA</div>
                            <div class="cert-details">
                                ‚Ä¢ <strong>Optional</strong> intermediate<br>
                                ‚Ä¢ Server-based key management<br>
                                ‚Ä¢ Similar to [E] for servers<br>
                                ‚Ä¢ CA=TRUE, pathLen=0<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F42h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.15</div>
                        </div>

                        <div class="arrow">‚Üì signs</div>

                        <div class="cert-box leaf">
                            <div class="cert-title">[T] SBxD/KIS Endpoint Certificate</div>
                            <div class="cert-details">
                                ‚Ä¢ Server-based key attestation<br>
                                ‚Ä¢ Similar to [H] for servers<br>
                                ‚Ä¢ <strong>Must have revocation check</strong><br>
                                ‚Ä¢ Contains service identifiers<br>
                                ‚Ä¢ Retrieved via tag: <strong>7F44h</strong>
                            </div>
                            <div class="cert-oid">OID: 1.3.6.1.4.1.41577.5.16</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Differences -->
            <div class="section">
                <h2>üéØ Key Differences Explained</h2>

                <div class="key-diff">
                    <div class="diff-card">
                        <h4>[E] vs [S]</h4>
                        <ul>
                            <li><strong>[E]</strong> is for device Secure Elements (SE)</li>
                            <li><strong>[S]</strong> is for server-based keys</li>
                            <li>Both are intermediate CA certificates</li>
                            <li>Both have CA=TRUE, pathLen=0</li>
                            <li>[S] is optional in the chain</li>
                            <li>[E] contains applet version info</li>
                            <li>[S] used in SiaC workflows</li>
                        </ul>
                    </div>

                    <div class="diff-card">
                        <h4>[H] vs [T]</h4>
                        <ul>
                            <li><strong>[H]</strong> attests device keys (phone)</li>
                            <li><strong>[T]</strong> attests server keys (cloud)</li>
                            <li>Both are leaf certificates</li>
                            <li>[H] has CA=FALSE</li>
                            <li>[T] has CA=TRUE (note: likely for signing)</li>
                            <li>[T] requires revocation checking</li>
                            <li>[H] validity not strictly checked</li>
                            <li>[T] includes service provider IDs</li>
                        </ul>
                    </div>

                    <div class="diff-card">
                        <h4>Device-Based vs Server-Based</h4>
                        <ul>
                            <li><strong>Device:</strong> [E] + [H] chain</li>
                            <li><strong>Server:</strong> [S] + [T] chain</li>
                            <li>Device uses phone's Secure Element</li>
                            <li>Server enables remote key management</li>
                            <li>Device for owner pairing</li>
                            <li>Server for sharing scenarios</li>
                            <li>Both validated by Vehicle OEM CA</li>
                        </ul>
                    </div>

                    <div class="diff-card">
                        <h4>When to Use Which?</h4>
                        <ul>
                            <li><strong>[E] + [H]:</strong> Normal phone-to-vehicle pairing</li>
                            <li><strong>[S] + [T]:</strong> Server-Based Owner Device (SBOD)</li>
                            <li><strong>[S] + [T]:</strong> Server-Based Friend Device (SBFD)</li>
                            <li><strong>[S] + [T]:</strong> Key Issuing Server (KIS)</li>
                            <li>All chains start with Vehicle OEM CA</li>
                            <li>All chains verified during key creation</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Detailed Breakdown -->
            <div class="section">
                <h2>üìã Detailed Certificate Breakdown</h2>

                <h3>[E] Instance CA Certificate</h3>
                <div class="tag-info">
                    <strong>GET DATA Tag:</strong> 7F22h | <strong>Max Size:</strong> 650 bytes | <strong>OID:</strong> 1.3.6.1.4.1.41577.5.3
                </div>
                <p><strong>Purpose:</strong> This intermediate CA certificate bridges the Device OEM CA and the actual Digital Key certificate. It's issued per Vehicle OEM and contains device-specific information.</p>
                <p><strong>Key Features:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Signed by Device OEM CA private key</li>
                    <li>Contains <code>applet_version</code> (mandatory, 4 bytes)</li>
                    <li>Optional <code>platform_information</code> (1-20 bytes)</li>
                    <li>Subject CN: <code>instance_CA_identifier</code> (Vehicle OEM Identifier, 4 chars)</li>
                    <li>Validity dates checked by vehicle, device, and KTS</li>
                    <li>Critical extensions: Instance CA extension, Key Usage (Cert Sign only), Basic Constraints (CA=TRUE, pathLen=0)</li>
                </ul>

                <h3>[H] Digital Key Certificate</h3>
                <div class="tag-info">
                    <strong>GET DATA Tag:</strong> 7F24h | <strong>Max Size:</strong> 650-970 bytes | <strong>OID:</strong> 1.3.6.1.4.1.41577.5.4
                </div>
                <p><strong>Purpose:</strong> The leaf certificate that proves the device owns a specific Digital Key. This is what the vehicle validates during owner pairing.</p>
                <p><strong>Key Features:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Signed by Instance CA private key</li>
                    <li>Subject CN format: <code>DIGK.[OWNR,FRND].[4-byte ASCII]|[optional text]</code></li>
                    <li>Contains complete endpoint configuration</li>
                    <li>Includes <code>vehicle_PK</code> (Vehicle Public Key)</li>
                    <li>May contain up to 5 <code>authorized_PK</code> entries</li>
                    <li>Expiration date <strong>not checked</strong> (key lifetime defined elsewhere)</li>
                    <li>Critical extensions: Endpoint Certificate extension, Key Usage (digitalSignature), Basic Constraints (CA=FALSE)</li>
                </ul>

                <h3>[S] SBxD/KIS Intermediate CA Certificate</h3>
                <div class="tag-info">
                    <strong>GET DATA Tag:</strong> 7F42h | <strong>Optional Certificate</strong> | <strong>OID:</strong> 1.3.6.1.4.1.41577.5.15
                </div>
                <p><strong>Purpose:</strong> Optional intermediate CA for server-based key infrastructure. Used when keys are managed by SBOD, SBFD, or KIS instead of device SE.</p>
                <p><strong>Key Features:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Structure similar to [E] but for server context</li>
                    <li>Subject CN: <code>intermediate_CA_identifier</code></li>
                    <li>Enables PKI flexibility in server deployments</li>
                    <li>Critical extensions: SBxD/KIS extension, Key Usage (Cert Sign only), Basic Constraints (CA=TRUE, pathLen=0)</li>
                </ul>

                <h3>[T] SBxD/KIS Endpoint Certificate</h3>
                <div class="tag-info">
                    <strong>GET DATA Tag:</strong> 7F44h | <strong>Requires Revocation Check</strong> | <strong>OID:</strong> 1.3.6.1.4.1.41577.5.16
                </div>
                <p><strong>Purpose:</strong> The server-side equivalent of [H]. Attests to keys managed by server infrastructure instead of device SE.</p>
                <p><strong>Key Features:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Structure similar to [H] but for server-managed keys</li>
                    <li><strong>Must contain revocation check method</strong> (CRL or OCSP)</li>
                    <li>Contains <code>key_server_provider_identifier</code></li>
                    <li>Contains <code>service_provider_identifier</code></li>
                    <li>Contains <code>service_identifier</code></li>
                    <li>Used in Key Creation Request from SBOD/KIS</li>
                    <li>Critical extensions: Standard Endpoint extension + SBxD/KIS extension</li>
                </ul>
            </div>

            <!-- Real-World Analogy -->
            <div class="section">
                <h2>üí° Real-World Analogy</h2>
                
                <div class="analogy">
                    <h4>üè¢ The Two Passport Offices Analogy</h4>
                    <p>
                        Imagine the Digital Key system has <strong>two separate passport offices</strong>:
                    </p>
                    <p style="margin-top: 15px;">
                        <strong>üì± The "Device Office" ([E] + [H]):</strong><br>
                        This office issues passports for your phone's built-in secure hardware (like a vault inside your phone). 
                        When you pair your phone with a car, the Device Office provides two documents:
                    </p>
                    <ul style="margin-left: 30px;">
                        <li><strong>[E]</strong> is like the "branch manager's credentials" - it proves this local branch is authorized</li>
                        <li><strong>[H]</strong> is like your actual "digital passport" - it proves YOUR phone's key is legitimate</li>
                    </ul>
                    <p style="margin-top: 15px;">
                        <strong>‚òÅÔ∏è The "Server Office" ([S] + [T]):</strong><br>
                        This office issues passports for keys managed in the cloud (not on your phone's hardware). 
                        This is useful when companies want to manage digital keys centrally, like a rental car company managing hundreds of temporary keys:
                    </p>
                    <ul style="margin-left: 30px;">
                        <li><strong>[S]</strong> is like the "regional manager's credentials" - it proves this cloud service is authorized (optional layer)</li>
                        <li><strong>[T]</strong> is like a "server-issued digital passport" - it proves the cloud-managed key is legitimate</li>
                    </ul>
                    <p style="margin-top: 15px;">
                        Both offices are supervised by the same authority (<strong>Vehicle OEM CA [J]</strong>), ensuring all keys - whether from your phone or from a server - are trusted by the vehicle.
                    </p>
                </div>
            </div>

            <!-- Usage Scenarios -->
            <div class="section">
                <h2>üé¨ Usage Scenarios</h2>

                <h3>Scenario 1: Normal Owner Pairing (Uses [E] + [H])</h3>
                <p>
                    <strong>User Story:</strong> Alice buys a new Mercedes. She pairs her iPhone with the car for the first time.
                </p>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>Alice's phone's Secure Element creates a new key pair</li>
                    <li>Vehicle requests certificates from phone:
                        <ul style="margin-left: 20px;">
                            <li>GET DATA 7F20h ‚Üí Receives [F] (Device OEM CA Certificate)</li>
                            <li>GET DATA 7F22h ‚Üí Receives <strong>[E]</strong> (Instance CA Certificate)</li>
                            <li>GET DATA 7F24h ‚Üí Receives <strong>[H]</strong> (Digital Key Certificate)</li>
                        </ul>
                    </li>
                    <li>Vehicle verifies the chain: [J] ‚Üí [F] ‚Üí <strong>[E]</strong> ‚Üí <strong>[H]</strong></li>
                    <li>If valid, Alice's phone is now paired as the owner device</li>
                </ol>

                <h3>Scenario 2: Server-Based Key Sharing (Uses [S] + [T])</h3>
                <p>
                    <strong>User Story:</strong> A rental car company (Hertz) manages digital keys for 1000s of vehicles through a central server.
                </p>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>Bob reserves a car through Hertz app</li>
                    <li>Hertz's Key Issuing Server (KIS) creates a temporary digital key for Bob</li>
                    <li>When Bob approaches the vehicle, the KIS provides:
                        <ul style="margin-left: 20px;">
                            <li>GET DATA 7F20h ‚Üí [F] (External CA Certificate)</li>
                            <li>GET DATA 7F42h ‚Üí <strong>[S]</strong> (SBxD/KIS Intermediate CA)</li>
                            <li>GET DATA 7F44h ‚Üí <strong>[T]</strong> (SBxD/KIS Endpoint Certificate)</li>
                        </ul>
                    </li>
                    <li>Vehicle verifies: [J] ‚Üí [F] ‚Üí <strong>[S]</strong> ‚Üí <strong>[T]</strong></li>
                    <li>Vehicle also checks revocation status of [T]</li>
                    <li>If valid and not revoked, Bob can access the car</li>
                </ol>
            </div>

            <!-- Quick Reference -->
            <div class="section">
                <h2>üìå Quick Reference: When to Use What</h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>If you need to...</th>
                            <th>Use these certificates</th>
                            <th>Context</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pair a phone as owner device</td>
                            <td><strong>[E] + [H]</strong></td>
                            <td>Normal consumer use case - owner pairing</td>
                        </tr>
                        <tr>
                            <td>Share key from phone to phone</td>
                            <td><strong>[E] + [H]</strong></td>
                            <td>Friend sharing from SE-based device</td>
                        </tr>
                        <tr>
                            <td>Manage keys via cloud server</td>
                            <td><strong>[S] + [T]</strong></td>
                            <td>Enterprise/fleet management (SiaC)</td>
                        </tr>
                        <tr>
                            <td>Issue temporary rental keys</td>
                            <td><strong>[S] + [T]</strong></td>
                            <td>Rental companies using KIS</td>
                        </tr>
                        <tr>
                            <td>Corporate car pool management</td>
                            <td><strong>[S] + [T]</strong></td>
                            <td>SBOD/SBFD scenarios</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Footer -->
            <div style="text-align: center; padding: 30px; background: #f8f9fa; border-radius: 10px; margin-top: 50px;">
                <p style="color: #666; font-size: 0.9em;">
                    üìö Based on CCC Digital Key Release 3 Specification<br>
                    üîê All certificates use 256-bit ECC (NIST P-256) and X.509 v3 formatting
                </p>
            </div>
        </div>
    </div>
</body>
</html>
